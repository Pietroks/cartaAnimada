<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carta Animada</title>
    <link rel="preload" href="envelope-1.webp" as="image" />
    <link rel="preload" href="envelope-3.webp" as="image" />
    <link rel="preload" href="envelope-4.webp" as="image" />
    <link rel="preload" href="envelope-5.webp" as="image" />
    <link rel="preload" href="carta-pt1.webp" as="image" />
    <link rel="preload" href="carta-pt2.webp" as="image" />
    <link rel="preload" href="carta-pt3.webp" as="image" />
    <link rel="preload" href="card-nivel1.webp" as="image" />
    <style>
      * {
        cursor: url("./img/wand_cursor_cartoon_96.png") 5 5, default;
      }

      body {
        margin: 0;
        background: radial-gradient(
          circle at var(--mouse-x, 50%) var(--mouse-y, 50%),
          #4a4a4a,
          #111 40%
        );
        font-family: "Georgia", serif;
        overflow: hidden;
        min-height: 100vh;
        transition: all 0.5s ease-in-out;
      }

      body.light-off {
        background: #000;
      }

      body.light-off .envelope-wrapper {
        filter: brightness(0.1);
        cursor: default;
      }

      canvas {
        position: absolute;
        top: 0;
        left: 0;
      }

      .envelope-wrapper {
        position: fixed;
        cursor: pointer;
        perspective: 2000px;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        transition: filter 0.4s ease;
      }

      .envelope-wrapper:hover {
        filter: brightness(1.05) saturate(1.1);
      }

      .envelope {
        position: relative;
        width: 380px;
        height: 250px;
        transform-style: flat;
        transition: box-shadow 0.4s ease;
      }

      .envelope-part {
        position: absolute;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        border-radius: 12px;
        will-change: transform, opacity;
        transition: opacity 0.4s ease;
      }

      .envelope-back {
        background-image: url("img/envelope-1.webp");
        z-index: 1;
      }

      .envelope-front {
        background-image: url("img/envelope-1.webp");
        z-index: 5;
      }

      .envelope-open-bottom {
        background-image: url("img/envelope-4.webp");
        z-index: 2;
        opacity: 0;
      }

      .envelope-middle {
        background-image: url("img/envelope-5.webp");
        z-index: 3;
        opacity: 0;
      }

      .envelope-open-top {
        background-image: url("img/envelope-3.webp");
        z-index: 1;
        opacity: 0;
        top: -95%;
        left: 0%;
        width: 100%;
      }

      .letter-container {
        position: absolute;
        top: 0;
        left: 5%;
        width: 90%;
        height: 250px;
        z-index: 2;
        transform-style: preserve-3d;
        border-radius: 12px;
        overflow: visible;
      }

      .letter-part {
        position: absolute;
        left: 0;
        width: 100%;
        height: 33.333%;
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        backface-visibility: hidden;
      }

      .letter-top {
        top: 0;
        background-image: url("img/carta-pt1.webp");
        transform-origin: bottom;
        transform: rotateX(-180deg);
        border-radius: 12px 12px 0 0;
      }

      .letter-middle {
        top: 33.333%;
        background-image: url("img/carta-pt2.webp");
      }

      .letter-bottom {
        bottom: 0;
        height: 33.333%;
        background-image: url("img/carta-pt3.webp");
        transform-origin: top;
        transform: rotateX(180deg);
        border-radius: 0 0 12px 12px;
      }

      .cardNivel1 {
        position: absolute;
        top: 350px;
        left: 50%;
        transform: translateX(-50%);
        width: 60%;
        height: auto;
        background-image: url("img/card-nivel1.webp");
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        opacity: 0;
        transform-origin: center;
        z-index: 11;
        cursor: pointer;
        transition: transform 0.4s ease, box-shadow 0.4s ease;
      }

      .magic-click {
        position: absolute;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: radial-gradient(
          circle,
          rgba(66, 200, 255, 0.8),
          rgba(20, 100, 255, 0.4),
          transparent
        );
        pointer-events: none;
        animation: sparkle 1.2s ease-out forwards;
        filter: blur(1px);
        z-index: 9999;
        box-shadow: 0 0 8px rgba(100, 200, 255, 0.6);
      }

      .magic-click::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 6px;
        height: 6px;
        background: white;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        box-shadow: 0 0 6px rgba(255, 255, 255, 0.8),
          0 0 12px rgba(173, 216, 255, 0.6), 0 0 20px rgba(173, 216, 255, 0.4);
      }

      @keyframes sparkle {
        0% {
          transform: scale(0.8);
          opacity: 1;
        }
        50% {
          transform: scale(2.5);
          opacity: 0.8;
        }
        100% {
          transform: scale(4);
          opacity: 0;
        }
      }

      #telaQuebrada {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: url("/img/tela-quebrada.jpg") no-repeat center center;
        background-size: cover;
        z-index: 9999;
        display: none;
        pointer-events: none;
      }

      .raio {
        position: fixed;
        top: 0;
        width: 6px;
        background: linear-gradient(white, rgba(255, 255, 255, 0.3));
        height: 0;
        z-index: 9998;
        animation: raioReal 0.3s ease-out forwards;
        transform: translateX(-50%);
        border-radius: 3px;
      }

      @keyframes raioReal {
        0% {
          height: 0;
          opacity: 0.8;
          box-shadow: 0 0 20px white;
          filter: hue-rotate(0deg);
        }
        50% {
          height: 100vh;
          opacity: 1;
          box-shadow: 0 0 50px white;
          filter: hue-rotate(45deg);
        }
        100% {
          height: 0;
          opacity: 0;
          box-shadow: 0 0 0 transparent;
          filter: hue-rotate(136deg);
        }
      }

      body.tremor {
        animation: tremer 0.1s ease-in-out infinite;
      }
      body.tremor .raio {
        animation: raioReal 0.3s ease-out forwards,
          tremer 0.1s ease-in-out infinite;
      }
      body.tremor .envelope-wrapper {
        filter: brightness(0.5);
      }
      @keyframes tremer {
        0% {
          transform: translate(0px, 0px) rotate(0deg);
        }
        15% {
          transform: translate(-10px, 8px) rotate(1deg);
        }
        30% {
          transform: translate(12px, -6px) rotate(-1.5deg);
        }
        45% {
          transform: translate(-8px, 10px) rotate(1.2deg);
        }
        60% {
          transform: translate(10px, -12px) rotate(-4deg);
        }
        75% {
          transform: translate(-6px, 6px) rotate(1deg);
        }
        90% {
          transform: translate(6px, -8px) rotate(-1deg);
        }
        100% {
          transform: translate(0px, 0px) rotate(0deg);
        }
      }
    </style>
  </head>
  <body>
    <audio
      id="wandSound"
      src="./audio/surprise-sound-effect-99300.mp3"
      preload="auto"
    ></audio>
    <audio
      id="envelopeOpenSound"
      src="/audio/harp-piano-dreamy-flashback-jam-fx-1-00-07.mp3"
      preload="auto"
    ></audio>
    <audio
      id="envelopeCloseSound"
      src="/audio/heavy-thunder-sound-effect-no-copyright-338980.mp3"
      preload="auto"
    ></audio>
    <audio
      id="radioSignal"
      src="/audio/radio-signal.mp3"
      preload="auto"
    ></audio>

    <canvas id="starCanvas"></canvas>
    <div class="envelope-wrapper" id="envelopeWrapper">
      <div class="envelope" id="envelope">
        <div class="envelope-part envelope-back"></div>
        <div class="envelope-part envelope-open-bottom"></div>

        <div class="letter-container" id="letter">
          <div class="letter-part letter-top"></div>
          <div class="letter-part letter-middle"></div>
          <div class="letter-part letter-bottom"></div>
        </div>

        <div class="cardNivel1" id="cardNivel1" loading="lazy"></div>

        <div class="envelope-part envelope-front"></div>
        <div class="envelope-part envelope-middle"></div>
        <div class="envelope-part envelope-open-top"></div>
      </div>
    </div>

    <div>
      <div
        id="clickCounter"
        style="
          position: fixed;
          top: 20px;
          left: 20px;
          color: white;
          font-size: 20px;
          z-index: 99999;
          font-family: Georgia, serif;
        "
      >
        Cliques: 0
      </div>
    </div>
    <div id="carta"></div>
    <div id="telaQuebrada"></div>

    <audio id="somRaio" src="audio/raio.mp3" preload="auto"></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="/script.js"></script>
    <script src="/script-mouse-shit.js"></script>
    <script src="script-click-counter.js"></script>
  </body>
</html>
